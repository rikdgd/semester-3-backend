variables:
#   MAVEN_OPTS: -Dmaven.repo.local=.m2/repository
  DOCKER_USERNAME: rikdegoede
  DOCKER_PASSWORD: lXn6Ek0dPYnCEaRe1J6O

image: maven:latest

cache:
  paths:
    - .m2/repository
    - target

stages:
  - build
  - dockerize
  # - test
  # -package
  # -deploy

build_job:
  stage: build
  tags:
    - maven

  script:
    - echo "starting build"
    - "mvn compile"

dockerize_job:
  stage: dockerize
  tags:
    - docker
  
  script:
    - echo "start building container..."
    # - "docker info"
    - "docker build -t rikdegoede/pokemon-card-markt ."
    - "docker login $DOCKER_USERNAME $DOCKER_PASSWORD"
    - "docker push rikdegoede/pokemon-card-markt"

# test_job:
#   stage: test
#   tags:
#     - maven

#   script:
#     - echo "started testing"
#     - "mvn test"

# package_job:
#   stage: package
#   tags:
#     - docker

  # script:
  #   - echo "packaging stage started"
  #   - "mvn package"

